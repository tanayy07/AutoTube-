TITLE:
Build a full YouTube Downloader Telegram Bot (Next.js + Queue + Worker + ffmpeg + yt-dlp)
PROMPT:
You are my senior full-stack engineer.
Build a complete production-ready project like the Liora project structure, but instead of AI therapy, the bot will:
Download any YouTube video
Trim by start & end timestamp
Choose video quality
Convert to MP3 if requested
Send the processed file back to the user on Telegram
I want a full, end-to-end implementation with correct folder structure, clean code, and comments.

ğŸš§ Project Requirements (VERY IMPORTANT)
1. Framework
Next.js 15 (App Router)
TypeScript
pnpm preferred
2. Architecture
Use this structure (same philosophy as Liora):
ytbot/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ telegram/webhook/       # receives Telegram updates
â”‚   â”‚   â””â”€â”€ health/                 # simple health check for worker
â”‚   â”œâ”€â”€ paid/ (optional)
â”‚   â””â”€â”€ cancelled/ (optional)
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ downloader.ts               # yt-dlp + ffmpeg helper
â”‚   â”œâ”€â”€ queue.ts                    # BullMQ queue
â”‚   â”œâ”€â”€ telegram-client.ts          # Telegram sendMessage/sendDocument
â”‚   â”œâ”€â”€ config.ts                   # env variables
â”‚   â”œâ”€â”€ logger.ts                   # logger
â”‚   â””â”€â”€ types.ts                    # shared interfaces
â”œâ”€â”€ db/
â”‚   â”œâ”€â”€ schema.ts                   # job + user schema
â”‚   â”œâ”€â”€ index.ts
â”œâ”€â”€ worker/
â”‚   â”œâ”€â”€ index.ts                    # BullMQ worker
â”‚   â”œâ”€â”€ Dockerfile                  # ffmpeg + yt-dlp included
â”‚   â””â”€â”€ package.json
â””â”€â”€ drizzle/
    â””â”€â”€ migrations...


3. Telegram Bot Specs
Use webhook method (not polling)
Handle /dl <url> START=0:30 END=1:10 Q=720 MP3=true
Parse arguments safely
Validate user input
Enqueue the job in Redis (BullMQ)
Immediately reply: â€œYour job has been queued.â€
When job is complete:
Worker sends processed video or MP3 back via Telegram API

4. Processing Requirements
Worker must:
download using yt-dlp
trim using ffmpeg
convert to MP3 when requested
clean up temp files
send output to Telegram

5. Deployment Requirements
Generate:
Full Dockerfile for the worker (must include ffmpeg + yt-dlp)
Cloud Run deployment guide
Redis setup (Upstash or local Docker)
Vercel config for Next.js webhook
.env template with all variables

6. What Windsurf Must Deliver
I want Windsurf to generate:
âœ” Complete project folder created inside my workspace
âœ” All .ts files implemented fully
âœ” Full worker code
âœ” BullMQ integration
âœ” Telegram webhook route
âœ” Downloader functions
âœ” Sample migrations for Drizzle
âœ” Dockerfile for worker
âœ” README.md with:
setup instructions
how to run locally
how to deploy (Vercel + Cloud Run)
âœ” Optional: Small UI page explaining how to use the bot

ğŸ›  Additional Instructions
Code style:
Clean, readable TS
Comments explaining each function
Error handling properly
Reusable utilities
Avoid unnecessary complexity
Behavior:
If a file is too large for Telegram, reply with an error
Trim logic should try -c copy then fallback to re-encode
All temporary files must be auto-deleted
Quality:
Production-grade
No hardcoding
All env vars in config.ts
Modular structure

ğŸ§¨ FINAL PROMPT BLOCK
IMPORTANT:
Implement the full project now â€” generate all folders and files exactly in the structure given above.
Create all code (Next.js API, worker, queue, downloader, telegram client, Drizzle schema, Dockerfile, README).
Once structure is ready, ask if I want:
tests
monitoring
payment features
admin panel
user limits (rate limit)
Make this a complete, deployable, production-ready project.
NO mistkes 